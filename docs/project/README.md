# 前端交接

## 教师端组件库单元测试
使用['Vue Test Utils'](https://vue-test-utils.vuejs.org/zh/)进行单元测试
组件库中的每个组件都需写单元测试，不论大的小的。每次对组件进行修改，尽可能的去补充修改后的组件单元测试，使其覆盖率尽可能的多。

写在每个组件的__tests__文件夹下，xxx.spec.tsx即为单元测试文件，__snapshots__文件夹下面放测试快照。  
npm run test:unit命令可以跑到所有的 *.spec.js|jsx|ts|tsx文件  
要单独运行一个文件的测试可以使用: npx jest --watch ./src/路径  来运行  
例：score-section.spec.tsx文件的单元测试执行命令：  
npx jest --watch ./src/score-board/__tests__/score-section.spec.tsx

编写单元测试时，每个props数据，data数据，计算属性，侦听器，方法都得测试到，可以打开JX-COMPONENTS目录下的coverage文件夹(与src文件夹同级)寻找对应的覆盖率文件查看每个分支，每条语句的测试覆盖情况。index.html文件是入口，显示当前文件夹内所有单元测试的情况。  

全局覆盖率更新，使用：npm run test:coverage命令  
全局单元测试通过情况，使用： npm run test:unit命令  
全局测试快照更新， 使用： npm run test:update-snapshot命令  

因为是纯组件，所以没有业务逻辑，也就没有真实数据。所有单元测试使用的数据，皆为自己mock出来的数据，引入使用。  

## FRONT-END-E2E项目
此项目对H5家长端及教师端所有功能使用['Cypress'](https://docs.cypress.io/guides/overview/why-cypress.html)
进行了端对端的测试，项目越大，越要保证功能的正确与完整，此处测试也是每一个功能点都需做到覆盖。  

./cypress/integration文件夹下面分别对应不同项目的测试。  
json文件放入的都是测试使用的数据，此为端对端测试，所以数据皆由后端提供，即其中数据皆为接口数据。在做测试时需要调用接口获取哪份数据，给它就是(大多为未开发完成接口时自己造的接口数据)。如若接口数据完好，可劫持接口，也就不用自己再造了。接口劫持使用cy.route()

测试文件皆为.spec.js结尾的文件  

测试运行只需打开Cypress.exe,选择front-end-e2e文件打开即可。

文件夹./cypress/support/下面的：  
+ config.js文件内放置测试使用的环境地址及账号，此测试会真实调用接口，更改数据，所以尽量选择一些不重要，平时无人使用的账号来进行测试，若账号过期，自行找后端人员要新账号，并修改。  
+ commands.js文件放置了一些封装并挂载好了的方法，特定功能的测试会用到他们，直接当做方法调用就好。  

screenshots文件夹保存屏幕截图

## H5
家长端考试成绩趋势图页面，在总分页面处包含了额外学科的switch切换，此处设计之时使用了位图。  
例：有体育社会两门额外学科。选中即为1，不选中为0。  
体育社会都不选：0 0；  
体育不选，社会选中： 0 1；  
体育选中，社会不选： 1 0；  
体育社会都选中： 1 1；  
且后端返回数据也为位图，以二进制位图代表的十进制数为数组下标去找班级均分，年级均分，年级、班级排名等。

趋势图的点击平移与缩放，在line-char.vue组件中，靠start与end数据来控制生成renderData以达到左右平移，放大缩小的视觉效果。

家长端vip开通曾有根据不同年级不同学期显示不同开通时间的需求，比如:七年级上学期，可以选择半年到三年的开通时长, 九年级上学期仅有半年跟一年的开通时长选项；九年级下学期仅有半年开通时长的选择。但是因为市场问题，一直未曾加入。后端未设计返回学期字段，也就判断不出来是上学期还是下学期。此处可能要根据后期需求再更改。

开通vip显示的金额是与后端联调进行数据对比，前端计算与后端计算完全一致才可跳转付款页面，不然会跳转失败显示金额错误。
